<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ny_artsy_date.ny_artsy_date &mdash; ny_artsy_date  documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/togglebutton.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/mystnb.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/graphviz.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/togglebutton.js"></script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> ny_artsy_date
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../conduct.html">Code of Conduct</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../autoapi/index.html">API Reference</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">ny_artsy_date</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../index.html">Module code</a> &raquo;</li>
      <li>ny_artsy_date.ny_artsy_date</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for ny_artsy_date.ny_artsy_date</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">googlemaps</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">lxml</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">gmaps</span>
<span class="kn">from</span> <span class="nn">pandas</span> <span class="kn">import</span> <span class="n">json_normalize</span>
<span class="kn">import</span> <span class="nn">re</span>

<div class="viewcode-block" id="geocoding"><a class="viewcode-back" href="../../autoapi/ny_artsy_date/ny_artsy_date/index.html#ny_artsy_date.ny_artsy_date.geocoding">[docs]</a><span class="k">def</span> <span class="nf">geocoding</span><span class="p">(</span><span class="n">my_location</span><span class="p">,</span> <span class="n">google_maps_key</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to obtain latitude and longitude as needed given simple address data. This package interacts with google maps API </span>
<span class="sd">    to create our visualization, thus an API key is required. </span>
<span class="sd">        </span>
<span class="sd">        Args</span>
<span class="sd">        ----</span>
<span class="sd">        Required: </span>
<span class="sd">            my_location(str): Starting point address - must be within NYC Metro Location</span>
<span class="sd">            google_maps_key (str): Google maps API key needed to geocode your location </span>
<span class="sd">                To obtain a google maps API key, please refer to https://developers.google.com/maps</span>

<span class="sd">        Returns</span>
<span class="sd">        ---</span>
<span class="sd">        Latitude and Longitude</span>
<span class="sd">            Fields: </span>
<span class="sd">                lat(float): Latitude of location</span>
<span class="sd">                lon(float): Longitude of location</span>
<span class="sd">            </span>
<span class="sd">        Usage Example</span>
<span class="sd">        ---</span>
<span class="sd">        [in]:</span>
<span class="sd">            geocode_events(&quot;Met Museum&quot;, google_maps_key)</span>
<span class="sd">            </span>
<span class="sd">        [out]:</span>
<span class="sd">            [40.7794, -73.9632]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">if</span> <span class="n">google_maps_key</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;AI&#39;</span><span class="p">):</span>
        <span class="n">google_maps</span> <span class="o">=</span> <span class="n">googlemaps</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">google_maps_key</span><span class="p">)</span> 
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid Google Maps Key. Please Refer to https://developers.google.com/maps to obtain a valid key.&quot;</span><span class="p">)</span>
                
    <span class="n">geocode_result</span> <span class="o">=</span> <span class="n">google_maps</span><span class="o">.</span><span class="n">geocode</span><span class="p">(</span><span class="n">my_location</span><span class="p">)</span>
    <span class="n">lat</span> <span class="o">=</span> <span class="n">geocode_result</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;geometry&#39;</span><span class="p">][</span><span class="s1">&#39;location&#39;</span><span class="p">][</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span>
    <span class="n">lon</span> <span class="o">=</span> <span class="n">geocode_result</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;geometry&#39;</span><span class="p">][</span><span class="s1">&#39;location&#39;</span><span class="p">][</span><span class="s1">&#39;lng&#39;</span><span class="p">]</span>
    
    <span class="k">return</span> <span class="n">lat</span><span class="p">,</span> <span class="n">lon</span></div>



<div class="viewcode-block" id="map_events"><a class="viewcode-back" href="../../autoapi/ny_artsy_date/ny_artsy_date/index.html#ny_artsy_date.ny_artsy_date.map_events">[docs]</a><span class="k">def</span> <span class="nf">map_events</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">google_maps_key</span><span class="p">,</span> <span class="n">lat_column</span><span class="p">,</span> <span class="n">long_column</span><span class="p">,</span> <span class="n">name_column</span><span class="p">,</span> <span class="n">start_lon</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">start_lat</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to map latitude and longitude as needed given simple address dataframe. This package interacts with google maps API </span>
<span class="sd">    to create our visualization, thus an API key is required. </span>
<span class="sd">        </span>
<span class="sd">        Args</span>
<span class="sd">        ----</span>
<span class="sd">        Required: </span>
<span class="sd">            df(str): Starting point address - must be within NYC Metro Location</span>
<span class="sd">            google_maps_key (str): Google maps API key needed to geocode your location </span>
<span class="sd">                To obtain a google maps API key, please refer to https://developers.google.com/maps</span>
<span class="sd">            lat_column(str): name of df column containing latitude data we need (events, restaurants, etc)</span>
<span class="sd">            long_column(str): name of df column containing latitude data we need (events, restaurants, etc)</span>
<span class="sd">                To obtain a google maps API key, please refer to https://developers.google.com/maps</span>
<span class="sd">            name_column(str): name of df column containing name data we need (events, restaurants, etc)</span>
<span class="sd">        Optional:</span>
<span class="sd">            start_lon: longitudinal data of starting point </span>
<span class="sd">            start_lat: latitudinal data of starting point </span>

<span class="sd">        Returns</span>
<span class="sd">        ---</span>
<span class="sd">        Google Map with markers at the specified points </span>
<span class="sd">            </span>
<span class="sd">        Usage Example</span>
<span class="sd">        ---</span>
<span class="sd">        [in]:</span>
<span class="sd">            map_events(df, google_maps_key,&#39;Lat&#39;,&#39;Long&#39;,&#39;Name&#39;)</span>
<span class="sd">            </span>
<span class="sd">        [out]:</span>
<span class="sd">            Map (Optional): Interactive Google Maps Output with Hover Text Description of Data Point  </span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">marker_locations</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">lat_column</span><span class="p">,</span> <span class="n">long_column</span><span class="p">]]</span>

    <span class="n">hover_info</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">name_column</span><span class="p">]</span>

    <span class="n">central_coordinates</span> <span class="o">=</span>  <span class="n">df</span><span class="p">[[</span><span class="n">lat_column</span><span class="p">,</span> <span class="n">long_column</span><span class="p">]]</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">gmaps</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="n">central_coordinates</span><span class="p">,</span> <span class="n">zoom_level</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

    <span class="n">markers</span> <span class="o">=</span> <span class="n">gmaps</span><span class="o">.</span><span class="n">marker_layer</span><span class="p">(</span><span class="n">marker_locations</span><span class="p">,</span> <span class="n">hover_text</span> <span class="o">=</span> <span class="n">hover_info</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">markers</span><span class="p">)</span>
    
    <span class="c1"># Optional to add starting point - default when working with other package functions </span>
    <span class="k">if</span> <span class="n">start_lat</span> <span class="o">!=</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">start_lon</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">start_locations</span> <span class="o">=</span> <span class="p">[[</span><span class="n">start_lat</span><span class="p">,</span> <span class="n">start_lon</span><span class="p">]]</span>
        <span class="n">start_layer</span> <span class="o">=</span> <span class="n">gmaps</span><span class="o">.</span><span class="n">symbol_layer</span><span class="p">(</span><span class="n">start_locations</span><span class="p">,</span> <span class="n">fill_color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">stroke_color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">hover_text</span> <span class="o">=</span> <span class="s1">&#39;Starting Point&#39;</span><span class="p">)</span>    
        <span class="n">fig</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">start_layer</span><span class="p">)</span>
        
    <span class="n">gmaps</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">api_key</span><span class="o">=</span><span class="n">google_maps_key</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">fig</span></div>


<div class="viewcode-block" id="find_my_art_events"><a class="viewcode-back" href="../../autoapi/ny_artsy_date/ny_artsy_date/index.html#ny_artsy_date.ny_artsy_date.find_my_art_events">[docs]</a><span class="k">def</span> <span class="nf">find_my_art_events</span><span class="p">(</span><span class="n">my_location</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">google_maps_key</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">lat</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">lon</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">free_only</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">max_results</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">NaN</span><span class="p">,</span> <span class="n">search_range</span> <span class="o">=</span> <span class="s1">&#39;500m&#39;</span><span class="p">,</span> <span class="n">mapping</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to obtain art events data in the NY Metro area near a specified location (address OR latitude and longitude format), </span>
<span class="sd">    using the NY ArtBeat API found at https://www.nyartbeat.com/resources/doc/api. Returns table with events matching a specified radius </span>
<span class="sd">    from a specified location as well as map if requested. </span>
<span class="sd">        </span>
<span class="sd">        Args</span>
<span class="sd">        ----</span>
<span class="sd">        Required: </span>
<span class="sd">            my_location(str): Address starting point - Must be within NYC Metro Location</span>
<span class="sd">                Default: None</span>
<span class="sd">            google_maps_key (str): Google maps API key needed to geocode your location </span>
<span class="sd">                To obtain a google maps API key, please refer to https://developers.google.com/maps</span>
<span class="sd">                Default: None, OR </span>
<span class="sd">            lat(float): Latitude of starting point - Must be within NYC Metro Location </span>
<span class="sd">                Default: None            </span>
<span class="sd">            lon(float): Longitude of starting point - Must be within NYC Metro Location </span>
<span class="sd">                Default: None            </span>
<span class="sd">        Optional:</span>
<span class="sd">            google_maps_key (str): Google maps API key needed to geocode your location OPTIONAL if you have lat-lon location data</span>
<span class="sd">                To obtain a google maps API key, please refer to https://developers.google.com/maps</span>
<span class="sd">                Default: None</span>
<span class="sd">            free_only(bool): Boolean param specifying whether to only return free events </span>
<span class="sd">                Default: False or 0</span>
<span class="sd">            max_results(int): Max results to be returned in Query - can be 5, 10, 20, 50 </span>
<span class="sd">                Default: np.NaN</span>
<span class="sd">            search_range(str/float): distance (in meters) from location for events queried - can be &#39;500m&#39;,&quot;1000m&quot;,&quot;1500m&quot;,&quot;3000m&quot;</span>
<span class="sd">                Default: 500m</span>
<span class="sd">            mapping(bool): Boolean param specifying whether user wants a simple interactive map returned of matching locations</span>

<span class="sd">        Returns</span>
<span class="sd">        ---</span>
<span class="sd">        DataFrame with [max_results] art events in the New York Metro area in the [radius] of the [specified location]</span>
<span class="sd">            Fields: </span>
<span class="sd">                Event_Name(str): Name of Event </span>
<span class="sd">                Event_Description(str): Details about event</span>
<span class="sd">                Event_Price_Adult(float): Price for tickets</span>
<span class="sd">                Event_Price_Detailed(str)): Price for tickets (detailed info)</span>
<span class="sd">                DateEnd(date): Last date for exhibit or installation</span>
<span class="sd">                Event_Lat(float): Latitude of event </span>
<span class="sd">                Event_Lon(float): Longitude of event</span>
<span class="sd">                Event_Address(str): Address for event - requires geocoding; google maps key (above).       </span>
<span class="sd">        Map (Optional): Interactive Google Maps Output with Markers for each event; Hover Text Description of Event  </span>
<span class="sd">      </span>
<span class="sd">        Usage Example</span>
<span class="sd">        ---</span>
<span class="sd">        [in]: </span>
<span class="sd">            find_my_art_events(lat = 40.78, lon = -73.96, search_range = &#39;3000m&#39;, max_results = 5)     </span>
<span class="sd">        [out]: </span>
<span class="sd">            df </span>
<span class="sd">            | Event_Name | Event_Description         | Price      | DateEnd | Distance | Latitude | Longitude | Event_Address                 | </span>
<span class="sd">            |------------|---------------------------|------------|---------|----------|----------|-----------|-------------------------------|</span>
<span class="sd">            | The..      | The Costume Institute’s...| Adults $25 | 2022-09 |    90.158|    40.779|    -73.96 | 1005 5th Ave, New York...     |</span>
<span class="sd">        [out]: </span>
<span class="sd">            Interactive Map  </span>
<span class="sd">            </span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">valid_search_range</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;500m&#39;</span><span class="p">,</span><span class="s2">&quot;1000m&quot;</span><span class="p">,</span><span class="s2">&quot;1500m&quot;</span><span class="p">,</span><span class="s2">&quot;3000m&quot;</span><span class="p">}</span>
    <span class="n">valid_max_results</span> <span class="o">=</span> <span class="p">{</span><span class="n">np</span><span class="o">.</span><span class="n">NaN</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">50</span><span class="p">}</span> 

    <span class="k">try</span><span class="p">:</span>
        <span class="nb">float</span><span class="p">(</span><span class="n">search_range</span><span class="p">)</span>
        <span class="n">search_range</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">search_range</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;m&quot;</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="kc">None</span>  

    <span class="k">if</span> <span class="n">search_range</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">valid_search_range</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;search range must be one of </span><span class="si">%r</span><span class="s2">.&quot;</span> <span class="o">%</span> <span class="n">valid_search_range</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">max_results</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">NaN</span> <span class="ow">and</span> <span class="n">max_results</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">valid_max_results</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;max results must be one of </span><span class="si">%r</span><span class="s2">.&quot;</span> <span class="o">%</span> <span class="n">valid_max_results</span><span class="p">)</span>
        
    
    <span class="k">assert</span> <span class="n">my_location</span> <span class="o">!=</span> <span class="kc">None</span> <span class="ow">or</span> <span class="p">(</span><span class="n">lat</span> <span class="o">!=</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">lon</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">),</span> <span class="s1">&#39;Please make sure there are valid address parameters (address or lat/lon).&#39;</span>
    <span class="k">if</span> <span class="n">lat</span> <span class="o">==</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">lon</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span> 
        <span class="n">lat</span><span class="p">,</span><span class="n">lon</span> <span class="o">=</span> <span class="n">geocoding</span><span class="p">(</span><span class="n">my_location</span><span class="p">,</span> <span class="n">google_maps_key</span><span class="p">)</span>
        
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;http://www.nyartbeat.com/list/event_searchNear&#39;</span><span class="p">,</span>
                            <span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Latitude&#39;</span><span class="p">:</span> <span class="n">lat</span><span class="p">,</span> <span class="s1">&#39;Longitude&#39;</span><span class="p">:</span> <span class="n">lon</span><span class="p">,</span><span class="s1">&#39;MaxResults&#39;</span><span class="p">:</span> <span class="n">max_results</span><span class="p">,</span> <span class="s1">&#39;searchrange&#39;</span><span class="p">:</span><span class="n">search_range</span><span class="p">}</span>
                                      <span class="p">)</span>
    <span class="k">try</span><span class="p">:</span> 
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_xml</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No Results Found. Please try increasing your search range and make sure you are searching within the metro area.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
    
    <span class="k">try</span><span class="p">:</span> 
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Event_Price_Adult&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">j</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="nb">list</span> <span class="o">=</span> <span class="p">[</span><span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="k">for</span> <span class="n">match</span> <span class="ow">in</span> <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;(adult|adults|admission)(\s|\s\$|\s\:|\:\s|\:\s\$|\:\$)(\d{1,2})&#39;</span><span class="p">,</span> <span class="n">l</span><span class="p">)</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span> <span class="k">if</span> <span class="n">match</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">:</span> 
            <span class="n">string</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s1">&#39;Price&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">string</span> <span class="o">==</span> <span class="s1">&#39;free&#39;</span><span class="p">):</span>
                <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s1">&#39;Event_Price_Adult&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> 
            <span class="k">elif</span> <span class="p">(</span><span class="s1">&#39;suggest&#39;</span> <span class="ow">in</span> <span class="n">string</span><span class="p">)</span> <span class="ow">and</span>  <span class="p">(</span><span class="s1">&#39;donate&#39;</span> <span class="ow">or</span> <span class="s1">&#39;donation&#39;</span> <span class="ow">or</span> <span class="s1">&#39;contribute&#39;</span> <span class="ow">or</span> <span class="s1">&#39;contribution&#39;</span> <span class="ow">in</span> <span class="n">string</span><span class="p">)</span> <span class="p">:</span> <span class="c1"># e.g., suggested donate</span>
                <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s1">&#39;Event_Price_Adult&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">elif</span> <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;(adult|adults|admission)(\s|\s\$|\s\:|\:\s|\:\s\$|\:\$)(\d{1,2})&#39;</span><span class="p">,</span> <span class="n">string</span><span class="p">)]</span> <span class="o">!=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]:</span>
                <span class="n">j</span> <span class="o">=</span> <span class="n">j</span><span class="o">+</span><span class="mi">1</span> 
                <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s1">&#39;Event_Price_Adult&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>  
            <span class="k">else</span><span class="p">:</span> 
                <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s1">&#39;Event_Price_Adult&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">NaN</span>
    <span class="k">except</span><span class="p">:</span> 
        <span class="kc">None</span> 
        

    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">free_only</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">free_only</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Event_Price_Adult&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">free_only</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">free_only</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span> 
            <span class="kc">None</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;search range must be 0,1, True, or False&quot;</span><span class="p">)</span>
        
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;url&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;href&#39;</span><span class="p">]</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Name&#39;</span><span class="p">:</span><span class="s1">&#39;Event_Name&#39;</span><span class="p">,</span><span class="s1">&#39;Description&#39;</span><span class="p">:</span><span class="s1">&#39;Event_Description&#39;</span><span class="p">,</span><span class="s1">&#39;Latitude&#39;</span><span class="p">:</span><span class="s1">&#39;Event_Lat&#39;</span><span class="p">,</span><span class="s1">&#39;Longitude&#39;</span><span class="p">:</span><span class="s1">&#39;Event_Lon&#39;</span><span class="p">,</span><span class="s1">&#39;Price&#39;</span><span class="p">:</span><span class="s1">&#39;Event_Price_Detailed&#39;</span><span class="p">})</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;Event_Name&#39;</span><span class="p">,</span><span class="s1">&#39;Event_Description&#39;</span><span class="p">,</span><span class="s1">&#39;DateEnd&#39;</span><span class="p">,</span><span class="s1">&#39;Distance&#39;</span><span class="p">,</span><span class="s1">&#39;Event_Lat&#39;</span><span class="p">,</span><span class="s1">&#39;Event_Lon&#39;</span><span class="p">,</span><span class="s1">&#39;Event_Price_Adult&#39;</span><span class="p">,</span><span class="s1">&#39;url&#39;</span><span class="p">,</span><span class="s1">&#39;Event_Price_Detailed&#39;</span><span class="p">]]</span>
   
    <span class="k">if</span> <span class="n">google_maps_key</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>  
        <span class="k">if</span> <span class="n">google_maps_key</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;AI&#39;</span><span class="p">):</span>
            <span class="n">google_maps</span> <span class="o">=</span> <span class="n">googlemaps</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">google_maps_key</span><span class="p">)</span> 
            <span class="k">try</span><span class="p">:</span>
                <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Event_Address&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">google_maps</span><span class="o">.</span><span class="n">reverse_geocode</span><span class="p">((</span><span class="n">x</span><span class="o">.</span><span class="n">Event_Lat</span><span class="p">,</span>\
                                                                                      <span class="n">x</span><span class="o">.</span><span class="n">Event_Lon</span><span class="p">)),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;formatted_address&#39;</span><span class="p">]</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid Google Maps Key. Please Refer to https://developers.google.com/maps to obtain a valid key.&quot;</span><span class="p">)</span>
            
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="s1">&#39;Distance&#39;</span><span class="p">)</span> 
        
    <span class="k">if</span> <span class="n">mapping</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span> 
        <span class="n">nymap</span> <span class="o">=</span> <span class="n">map_events</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">google_maps_key</span> <span class="o">=</span> <span class="n">google_maps_key</span><span class="p">,</span> <span class="n">start_lat</span> <span class="o">=</span> <span class="n">lat</span><span class="p">,</span> <span class="n">start_lon</span> <span class="o">=</span> <span class="n">lon</span><span class="p">,</span> <span class="n">lat_column</span> <span class="o">=</span> <span class="s2">&quot;Event_Lat&quot;</span><span class="p">,</span> <span class="n">long_column</span> <span class="o">=</span> <span class="s2">&quot;Event_Lon&quot;</span><span class="p">,</span> <span class="n">name_column</span> <span class="o">=</span> <span class="s1">&#39;Event_Name&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">df</span><span class="p">,</span> <span class="n">nymap</span>
    
    <span class="k">else</span><span class="p">:</span> 
        <span class="k">return</span> <span class="n">df</span></div>

    

<div class="viewcode-block" id="find_my_dinner"><a class="viewcode-back" href="../../autoapi/ny_artsy_date/ny_artsy_date/index.html#ny_artsy_date.ny_artsy_date.find_my_dinner">[docs]</a><span class="k">def</span> <span class="nf">find_my_dinner</span><span class="p">(</span><span class="n">google_maps_key</span><span class="p">,</span> <span class="n">my_location</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">mapping</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">lat</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">lon</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">search_range</span> <span class="o">=</span> <span class="mi">500</span><span class="p">,</span> <span class="n">min_rating</span> <span class="o">=</span> <span class="mf">4.3</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns Restaurant List within a specified range at a specified minimum rating (address OR latitude and longitude format).</span>
<span class="sd">        Args</span>
<span class="sd">        ----</span>
<span class="sd">        Required: </span>
<span class="sd">            my_location(str): Address starting point - Must be within NYC Metro Location</span>
<span class="sd">                Default: None</span>
<span class="sd">            google_maps_key (str): Google maps API key needed to geocode your location </span>
<span class="sd">                To obtain a google maps API key, please refer to https://developers.google.com/maps</span>
<span class="sd">                Default: None, OR </span>
<span class="sd">            lat(float): Latitude of starting point - Must be within NYC Metro Location </span>
<span class="sd">                Default: None            </span>
<span class="sd">            lon(float): Longitude of starting point - Must be within NYC Metro Location </span>
<span class="sd">                Default: None</span>
<span class="sd">        Optional:</span>
<span class="sd">            search_range(float): Distance from starting point (radius for search, meters) </span>
<span class="sd">                Default: 500</span>
<span class="sd">            min_rating(float): should be 1-5</span>
<span class="sd">                Default: 4.3</span>
<span class="sd">            mapping(bool): Boolean param specifying whether user wants a simple interactive map returned of matching locations</span>
<span class="sd">                Default: False</span>

<span class="sd">        Returns</span>
<span class="sd">        ---</span>
<span class="sd">        DataFrame with [max_results] restaurants in the New York Metro area in the [radius] of the [specified location]</span>
<span class="sd">            Fields: </span>
<span class="sd">                Restaurant_Name(str): Name of restaurant </span>
<span class="sd">                Price_Level(str): $ - $$$$</span>
<span class="sd">                Restaurant_Rating(float): 1-5</span>
<span class="sd">                Restaurant_Address(str): Distance from starting point (my location) </span>
<span class="sd">                Restaurant_Lat(float): Latitude of restaurant </span>
<span class="sd">                Restaurant_Lon(float): Longitude of restaurant  </span>
<span class="sd">        Map (Optional): Interactive Google Maps Output with Markers for each restaurant; Hover Text Description of Restaurant  </span>

<span class="sd">        Usage Example</span>
<span class="sd">        ---</span>
<span class="sd">        [in]:</span>
<span class="sd">            find_my_dinner(my_location = &#39;314 11th Ave, New York&#39;,google_maps_key = google_maps_key)</span>
<span class="sd">        [out]: </span>
<span class="sd">            df </span>
<span class="sd">            | Restaurant_Name | Price_Level      | Restaurant_Rating | Restaurant_Address | </span>
<span class="sd">            |-----------------|------------------|-------------------|--------------------|</span>
<span class="sd">            | The Four Seasons| $$$$             | 4.5               |      &#39;1234 Main St&#39;|</span>
<span class="sd">        [out]: </span>
<span class="sd">            Interactive Map            </span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">assert</span> <span class="n">my_location</span> <span class="o">!=</span> <span class="kc">None</span> <span class="ow">or</span> <span class="p">(</span><span class="n">lat</span> <span class="o">!=</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">lon</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">),</span> <span class="s1">&#39;Please make sure there are valid address parameters (address or lat/lon).&#39;</span>
    <span class="k">assert</span> <span class="n">min_rating</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">min_rating</span> <span class="o">&lt;=</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;Please make sure there are valid address parameters (address or lat/lon).&#39;</span>

    <span class="k">if</span> <span class="n">lat</span> <span class="o">==</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">lon</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span> 
        <span class="n">lat</span><span class="p">,</span><span class="n">lon</span> <span class="o">=</span> <span class="n">geocoding</span><span class="p">(</span><span class="n">my_location</span><span class="p">,</span> <span class="n">google_maps_key</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span> 
        <span class="kc">None</span>
    
    <span class="k">if</span> <span class="n">google_maps_key</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;AI&#39;</span><span class="p">):</span>
        <span class="n">google_maps</span> <span class="o">=</span> <span class="n">googlemaps</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">google_maps_key</span><span class="p">)</span> 
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid Google Maps Key. Please Refer to https://developers.google.com/maps to obtain a valid key.&quot;</span><span class="p">)</span>
        
    <span class="n">nearby_restaurants</span> <span class="o">=</span> <span class="n">google_maps</span><span class="o">.</span><span class="n">places_nearby</span><span class="p">(</span><span class="n">location</span> <span class="o">=</span> <span class="p">[</span><span class="n">lat</span><span class="p">,</span><span class="n">lon</span><span class="p">],</span><span class="n">radius</span> <span class="o">=</span> <span class="mi">500</span><span class="p">,</span><span class="n">keyword</span> <span class="o">=</span> <span class="s1">&#39;restaurant&#39;</span><span class="p">)</span>
    <span class="n">nearby_restaurants_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_records</span><span class="p">(</span><span class="n">nearby_restaurants</span><span class="p">[</span><span class="s1">&#39;results&#39;</span><span class="p">])</span>
    
    <span class="n">lat_lon</span> <span class="o">=</span> <span class="n">json_normalize</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">nearby_restaurants_df</span><span class="p">[[</span><span class="s1">&#39;geometry&#39;</span><span class="p">]][</span><span class="s1">&#39;geometry&#39;</span><span class="p">])</span>
    <span class="n">lat_lon</span> <span class="o">=</span> <span class="n">lat_lon</span><span class="p">[[</span><span class="s1">&#39;location.lat&#39;</span><span class="p">,</span><span class="s1">&#39;location.lng&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;location.lat&#39;</span><span class="p">:</span><span class="s1">&#39;Restaurant_Lat&#39;</span><span class="p">,</span><span class="s1">&#39;location.lng&#39;</span><span class="p">:</span><span class="s1">&#39;Restaurant_Lon&#39;</span><span class="p">})</span>
    
    <span class="n">nearby_restaurants_df</span> <span class="o">=</span> <span class="n">nearby_restaurants_df</span><span class="p">[[</span><span class="s1">&#39;name&#39;</span><span class="p">,</span><span class="s1">&#39;price_level&#39;</span><span class="p">,</span><span class="s1">&#39;rating&#39;</span><span class="p">,</span><span class="s1">&#39;vicinity&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;vicinity&#39;</span><span class="p">:</span><span class="s1">&#39;Restaurant_Address&#39;</span><span class="p">,</span><span class="s1">&#39;rating&#39;</span><span class="p">:</span><span class="s1">&#39;Restaurant_Rating&#39;</span><span class="p">,</span><span class="s1">&#39;price_level&#39;</span><span class="p">:</span><span class="s1">&#39;Price_Level&#39;</span><span class="p">,</span><span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="s1">&#39;Restaurant_Name&#39;</span><span class="p">})</span>  
    <span class="n">nearby_restaurants_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">nearby_restaurants_df</span><span class="p">,</span><span class="n">lat_lon</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="n">nearby_restaurants_df</span><span class="p">[</span><span class="s1">&#39;Price_Level&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">nearby_restaurants_df</span><span class="p">[</span><span class="s1">&#39;Price_Level&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;$$$$&#39;</span><span class="p">,</span>
                                                <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">nearby_restaurants_df</span><span class="p">[</span><span class="s1">&#39;Price_Level&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;$$$&#39;</span><span class="p">,</span>
                                                        <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">nearby_restaurants_df</span><span class="p">[</span><span class="s1">&#39;Price_Level&#39;</span><span class="p">]</span> <span class="o">==</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;$$&#39;</span><span class="p">,</span>
                                                        <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">nearby_restaurants_df</span><span class="p">[</span><span class="s1">&#39;Price_Level&#39;</span><span class="p">]</span> <span class="o">==</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;$&#39;</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">NaN</span><span class="p">))))</span>

    <span class="n">nearby_restaurants_df</span> <span class="o">=</span> <span class="n">nearby_restaurants_df</span><span class="p">[</span><span class="n">nearby_restaurants_df</span><span class="p">[</span><span class="s1">&#39;Restaurant_Rating&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">min_rating</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">mapping</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span> 
        <span class="n">nymap</span> <span class="o">=</span> <span class="n">map_events</span><span class="p">(</span><span class="n">nearby_restaurants_df</span><span class="p">,</span> <span class="n">google_maps_key</span><span class="p">,</span> <span class="n">start_lat</span> <span class="o">=</span> <span class="n">lat</span><span class="p">,</span> <span class="n">start_lon</span> <span class="o">=</span> <span class="n">lon</span><span class="p">,</span> \
                           <span class="n">lat_column</span> <span class="o">=</span> <span class="s2">&quot;Restaurant_Lat&quot;</span><span class="p">,</span> <span class="n">long_column</span> <span class="o">=</span> <span class="s2">&quot;Restaurant_Lon&quot;</span><span class="p">,</span> <span class="n">name_column</span> <span class="o">=</span> <span class="s1">&#39;Restaurant_Name&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">nearby_restaurants_df</span><span class="p">,</span> <span class="n">nymap</span>
    <span class="k">else</span><span class="p">:</span> 
        <span class="k">return</span> <span class="n">nearby_restaurants_df</span></div>
    


<div class="viewcode-block" id="choose_my_art_date"><a class="viewcode-back" href="../../autoapi/ny_artsy_date/ny_artsy_date/index.html#ny_artsy_date.ny_artsy_date.choose_my_art_date">[docs]</a><span class="k">def</span> <span class="nf">choose_my_art_date</span><span class="p">(</span><span class="n">my_location</span><span class="p">,</span> <span class="n">google_maps_key</span><span class="p">,</span> <span class="n">mapping</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">search_range</span> <span class="o">=</span> <span class="mi">500</span><span class="p">,</span> <span class="n">min_rating</span> <span class="o">=</span> <span class="mf">4.3</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to select an artsy date and dinner; randomly selects local arts event from NY ArtBeat API </span>
<span class="sd">    found at https://www.nyartbeat.com/resources/doc/api, and uses the arts event data to determine a nearby restaurant. </span>
<span class="sd">        </span>
<span class="sd">        Args</span>
<span class="sd">        ----</span>
<span class="sd">        Required:</span>
<span class="sd">            my_location(str): Starting point address - must be within NYC Metro Location</span>
<span class="sd">            google_maps_key (str): Optional google maps API key needed to geocode your location </span>
<span class="sd">                To obtain a google maps API key, please refer to https://developers.google.com/maps</span>
<span class="sd">        Optional:</span>
<span class="sd">            search_range(float): Distance from starting point (radius for search, meters) </span>
<span class="sd">                Default: 500</span>
<span class="sd">            min_rating(float): should be 1-5</span>
<span class="sd">                Default: 4.3</span>
<span class="sd">            mapping(bool): Boolean param specifying whether user wants a simple interactive map returned of matching locations</span>
<span class="sd">                Default: False</span>

<span class="sd">        Returns        </span>
<span class="sd">        ---</span>
<span class="sd">        DataFrame with [max_results] art events in the New York Metro area in the [radius] of the [specified location]</span>
<span class="sd">            Fields: </span>
<span class="sd">                Event_Name(str): Name of Event </span>
<span class="sd">                Event_Description(str): Details about event</span>
<span class="sd">                Event_Price_Adult(float): Price for tickets</span>
<span class="sd">                DateEnd(date): Last date for exhibit or installation</span>
<span class="sd">                Event_Lat(float): Latitude of event </span>
<span class="sd">                Event_Lon(float): Longitude of event</span>
<span class="sd">                Event_Address(str): Address for event - requires geocoding.</span>
<span class="sd">                Restaurant_Name(str): Name of restaurant </span>
<span class="sd">                Price_Level(str): $ - $$$$</span>
<span class="sd">                Restaurant_Rating(float): 1-5</span>
<span class="sd">                Restaurant_Address(str): Distance from starting point (my location) </span>
<span class="sd">                Restaurant_Lat(float): Latitude of restaurant </span>
<span class="sd">                Restaurant_Lon(float): Longitude of restaurant</span>
<span class="sd">        Map (Optional): Interactive Google Maps Output with Markers for selected restaurant and selected event.</span>

<span class="sd">        Usage Example</span>
<span class="sd">        ---</span>
<span class="sd">        [in]:</span>
<span class="sd">            choose_my_art_date(&quot;Met Museum&quot;, google_maps_key)</span>
<span class="sd">        [out]:</span>
<span class="sd">            df</span>
<span class="sd">                | Event_Name        | Eugène Leroy “About Marina”</span>
<span class="sd">                | Event_Description | Michael Werner Gallery, New York presents an e...</span>
<span class="sd">                | Price             | Free</span>
<span class="sd">                | DateEnd           | 2021-12-23</span>
<span class="sd">                | Distance          | 438.962726</span>
<span class="sd">                | Event_Lat         | 40.775625</span>
<span class="sd">                ...</span>
<span class="sd">        [out]: </span>
<span class="sd">            Interactive Map  </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">lat</span><span class="p">,</span><span class="n">lon</span> <span class="o">=</span> <span class="n">geocoding</span><span class="p">(</span><span class="n">my_location</span> <span class="o">=</span> <span class="n">my_location</span><span class="p">,</span> <span class="n">google_maps_key</span> <span class="o">=</span> <span class="n">google_maps_key</span><span class="p">)</span>
   
    <span class="n">df_events</span> <span class="o">=</span> <span class="n">find_my_art_events</span><span class="p">(</span><span class="n">my_location</span> <span class="o">=</span> <span class="n">my_location</span><span class="p">,</span> <span class="n">google_maps_key</span> <span class="o">=</span> <span class="n">google_maps_key</span><span class="p">,</span> <span class="n">lat</span> <span class="o">=</span> <span class="n">lat</span><span class="p">,</span> <span class="n">lon</span> <span class="o">=</span> <span class="n">lon</span><span class="p">,</span> <span class="n">mapping</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">search_range</span> <span class="o">=</span> <span class="n">search_range</span><span class="p">)</span>
    <span class="n">selected_event_row</span> <span class="o">=</span> <span class="n">df_events</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">event_lat</span> <span class="o">=</span> <span class="n">selected_event_row</span><span class="p">[</span><span class="s1">&#39;Event_Lat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
    <span class="n">event_lon</span> <span class="o">=</span> <span class="n">selected_event_row</span><span class="p">[</span><span class="s1">&#39;Event_Lon&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
    
    <span class="n">df_dinner</span> <span class="o">=</span> <span class="n">find_my_dinner</span><span class="p">(</span><span class="n">lat</span> <span class="o">=</span> <span class="n">event_lat</span><span class="p">,</span> <span class="n">lon</span> <span class="o">=</span> <span class="n">event_lon</span><span class="p">,</span> <span class="n">google_maps_key</span> <span class="o">=</span> <span class="n">google_maps_key</span><span class="p">,</span> <span class="n">mapping</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">search_range</span> <span class="o">=</span> <span class="n">search_range</span><span class="p">)</span>
    
    <span class="n">selected_restaurant_row</span> <span class="o">=</span> <span class="n">df_dinner</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> 
    
    <span class="n">date_night_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">selected_event_row</span><span class="p">,</span><span class="n">selected_restaurant_row</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;level_1&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;level_0&#39;</span><span class="p">:</span><span class="s1">&#39;Field&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="s1">&#39;Value&#39;</span><span class="p">})</span>
    
    <span class="k">if</span> <span class="n">mapping</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span> 
        <span class="n">lat_lon_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">selected_event_row</span><span class="p">[[</span><span class="s1">&#39;Event_Name&#39;</span><span class="p">,</span><span class="s1">&#39;Event_Lat&#39;</span><span class="p">,</span><span class="s1">&#39;Event_Lon&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Event_Name&#39;</span><span class="p">:</span><span class="s1">&#39;Name&#39;</span><span class="p">,</span><span class="s1">&#39;Event_Lat&#39;</span><span class="p">:</span><span class="s1">&#39;Lat&#39;</span><span class="p">,</span><span class="s1">&#39;Event_Lon&#39;</span><span class="p">:</span><span class="s1">&#39;Lon&#39;</span><span class="p">}),</span>\
                                <span class="n">selected_restaurant_row</span><span class="p">[[</span><span class="s1">&#39;Restaurant_Name&#39;</span><span class="p">,</span><span class="s1">&#39;Restaurant_Lat&#39;</span><span class="p">,</span><span class="s1">&#39;Restaurant_Lon&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Restaurant_Name&#39;</span><span class="p">:</span><span class="s1">&#39;Name&#39;</span><span class="p">,</span><span class="s1">&#39;Restaurant_Lat&#39;</span><span class="p">:</span><span class="s1">&#39;Lat&#39;</span><span class="p">,</span><span class="s1">&#39;Restaurant_Lon&#39;</span><span class="p">:</span><span class="s1">&#39;Lon&#39;</span><span class="p">})],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
        <span class="n">nymap</span> <span class="o">=</span> <span class="n">map_events</span><span class="p">(</span><span class="n">lat_lon_df</span><span class="p">,</span> <span class="n">google_maps_key</span><span class="p">,</span> <span class="n">name_column</span> <span class="o">=</span> <span class="s1">&#39;Name&#39;</span><span class="p">,</span> <span class="n">start_lat</span> <span class="o">=</span> <span class="n">lat</span><span class="p">,</span> <span class="n">start_lon</span> <span class="o">=</span> <span class="n">lon</span><span class="p">,</span> <span class="n">lat_column</span> <span class="o">=</span> <span class="s1">&#39;Lat&#39;</span><span class="p">,</span> <span class="n">long_column</span> <span class="o">=</span> <span class="s1">&#39;Lon&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">date_night_df</span><span class="p">,</span><span class="n">nymap</span>
    <span class="k">else</span><span class="p">:</span> 
        <span class="k">return</span> <span class="n">date_night_df</span></div>
    
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Connie (Ye) Xu .</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>